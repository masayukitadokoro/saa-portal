{"version":3,"sources":["../../../../node_modules/lucide-react/src/icons/loader-circle.ts","../../../../app/mypage/settings/email/page.tsx"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [['path', { d: 'M21 12a9 9 0 1 1-6.219-8.56', key: '13zald' }]];\n\n/**\n * @component @name LoaderCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEgMTJhOSA5IDAgMSAxLTYuMjE5LTguNTYiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/loader-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst LoaderCircle = createLucideIcon('loader-circle', __iconNode);\n\nexport default LoaderCircle;\n","'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { Loader2 } from 'lucide-react';\n\nexport default function EmailSettingsPage() {\n  const [currentEmail, setCurrentEmail] = useState('');\n  const [newEmail, setNewEmail] = useState('');\n  const [confirmEmail, setConfirmEmail] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [message, setMessage] = useState<{ type: 'success' | 'error' | 'info'; text: string } | null>(null);\n\n  useEffect(() => {\n    fetchCurrentEmail();\n  }, []);\n\n  const fetchCurrentEmail = async () => {\n    try {\n      const res = await fetch('/api/mypage/profile');\n      if (res.ok) {\n        const data = await res.json();\n        setCurrentEmail(data.profile?.email || '');\n      }\n    } catch (error) {\n      console.error('Failed to fetch email:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const validateEmail = (email: string) => {\n    return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setMessage(null);\n\n    // バリデーション\n    if (!validateEmail(newEmail)) {\n      setMessage({ type: 'error', text: '有効なメールアドレスを入力してください' });\n      return;\n    }\n\n    if (newEmail !== confirmEmail) {\n      setMessage({ type: 'error', text: 'メールアドレスが一致しません' });\n      return;\n    }\n\n    if (newEmail === currentEmail) {\n      setMessage({ type: 'error', text: '現在と同じメールアドレスです' });\n      return;\n    }\n\n    setSaving(true);\n\n    try {\n      const res = await fetch('/api/mypage/email', {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ newEmail }),\n      });\n\n      const data = await res.json();\n\n      if (res.ok) {\n        setMessage({ \n          type: 'info', \n          text: '確認メールを送信しました。メール内のリンクをクリックして変更を完了してください。' \n        });\n        setNewEmail('');\n        setConfirmEmail('');\n      } else {\n        setMessage({ type: 'error', text: data.error || 'メールアドレスの変更に失敗しました' });\n      }\n    } catch (error) {\n      setMessage({ type: 'error', text: 'エラーが発生しました' });\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"p-8 flex justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-blue-500\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-8\">\n      <h1 className=\"text-2xl font-bold text-gray-900 mb-8\">メールアドレス設定</h1>\n\n      {message && (\n        <div className={`mb-6 p-4 rounded-lg ${\n          message.type === 'success' ? 'bg-green-50 text-green-700' : \n          message.type === 'info' ? 'bg-blue-50 text-blue-700' :\n          'bg-red-50 text-red-700'\n        }`}>\n          {message.text}\n        </div>\n      )}\n\n      <form onSubmit={handleSubmit} className=\"max-w-md\">\n        {/* 現在のメールアドレス */}\n        <div className=\"mb-6\">\n          <label className=\"block text-gray-700 font-medium mb-2\">\n            現在のメールアドレス\n          </label>\n          <div className=\"px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg text-gray-600\">\n            {currentEmail || '未設定'}\n          </div>\n        </div>\n\n        {/* 新しいメールアドレス */}\n        <div className=\"mb-6\">\n          <label className=\"block text-gray-700 font-medium mb-2\">\n            新しいメールアドレス\n          </label>\n          <input\n            type=\"email\"\n            value={newEmail}\n            onChange={(e) => setNewEmail(e.target.value)}\n            className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            placeholder=\"example@email.com\"\n          />\n        </div>\n\n        {/* 確認用 */}\n        <div className=\"mb-8\">\n          <label className=\"block text-gray-700 font-medium mb-2\">\n            確認\n          </label>\n          <input\n            type=\"email\"\n            value={confirmEmail}\n            onChange={(e) => setConfirmEmail(e.target.value)}\n            className={`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${\n              confirmEmail && confirmEmail !== newEmail\n                ? 'border-red-500'\n                : 'border-gray-300'\n            }`}\n            placeholder=\"確認のため再度入力\"\n          />\n          {confirmEmail && confirmEmail !== newEmail && (\n            <p className=\"mt-1 text-sm text-red-600\">メールアドレスが一致しません</p>\n          )}\n        </div>\n\n        {/* 送信ボタン */}\n        <button\n          type=\"submit\"\n          disabled={saving || !newEmail || newEmail !== confirmEmail}\n          className=\"px-6 py-3 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-medium\"\n        >\n          {saving ? (\n            <>\n              <Loader2 className=\"w-5 h-5 animate-spin\" />\n              送信中...\n            </>\n          ) : (\n            '送信する'\n          )}\n        </button>\n\n        <p className=\"mt-4 text-sm text-gray-500\">\n          ※ 新しいメールアドレスに確認メールが送信されます。<br />\n          メール内のリンクをクリックすると変更が完了します。\n        </p>\n      </form>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}