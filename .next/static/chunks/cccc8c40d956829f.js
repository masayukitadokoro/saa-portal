(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,s)=>{t.exports=e.r(76562)},3922,e=>{"use strict";e.i(29225);var t=e.i(72390);function s(){return(0,t.createBrowserClient)("https://bfjstgfcvbxlvvodqoxd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRjeHpicXBoZ25yYmJud3lvcWFmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyNDkzOTgsImV4cCI6MjA4MjgyNTM5OH0.kQI94c9Kh8KymiadcozMDi5lHSpjQN33Hl7wmN3FED8")}e.s(["createClient",()=>s])},4012,e=>{"use strict";e.i(43476);var t=e.i(71645);e.i(3922);let s=(0,t.createContext)({user:null,session:null,isLoading:!0,signOut:async()=>{}});e.s(["useAuth",0,()=>(0,t.useContext)(s)])},94888,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566),r=e.i(3922),l=e.i(4012);function i(){let[e,i]=(0,s.useState)(""),[c,n]=(0,s.useState)(""),[d,o]=(0,s.useState)(""),[u,m]=(0,s.useState)(""),[x,h]=(0,s.useState)(!1),[b,g]=(0,s.useState)(!1),[y,p]=(0,s.useState)(""),j=(0,a.useRouter)(),{user:f}=(0,l.useAuth)(),v=(0,r.createClient)();(0,s.useEffect)(()=>{N()},[]);let N=async()=>{let{data:e}=await v.auth.mfa.listFactors();e?.totp&&e.totp.length>0&&(g(!0),p(e.totp[0].id))},w=async()=>{h(!0),m("");try{let{data:e,error:t}=await v.auth.mfa.enroll({factorType:"totp",friendlyName:"å‹•ç”»æ¤œç´¢ã‚¢ãƒ—ãƒª"});if(t)return void m(t.message);e&&(i(e.totp.qr_code),n(e.totp.secret),p(e.id))}catch(e){m("2FAè¨­å®šã®é–‹å§‹ã«å¤±æ•—ã—ã¾ã—ãŸ")}finally{h(!1)}},I=async e=>{e.preventDefault(),h(!0),m("");try{let{data:e,error:t}=await v.auth.mfa.challenge({factorId:y});if(t)return void m(t.message);let{error:s}=await v.auth.mfa.verify({factorId:y,challengeId:e.id,code:d});if(s)return void m("èªè¨¼ã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“");g(!0),i(""),n("")}catch(e){m("2FAã®æœ‰åŠ¹åŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ")}finally{h(!1)}},C=async()=>{if(confirm("2æ®µéšŽèªè¨¼ã‚’ç„¡åŠ¹ã«ã—ã¾ã™ã‹ï¼Ÿ")){h(!0);try{let{error:e}=await v.auth.mfa.unenroll({factorId:y});e?m(e.message):(g(!1),p(""))}catch(e){m("2FAã®ç„¡åŠ¹åŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ")}finally{h(!1)}}};return f?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,t.jsxs)("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow p-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-center text-gray-800 mb-8",children:"2æ®µéšŽèªè¨¼è¨­å®š"}),u&&(0,t.jsx)("div",{className:"mb-6 p-3 bg-red-50 border border-red-200 rounded text-red-600 text-sm",children:u}),b?(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-5xl mb-4",children:"ðŸ”’"}),(0,t.jsx)("p",{className:"text-green-600 font-medium mb-6",children:"2æ®µéšŽèªè¨¼ãŒæœ‰åŠ¹ã§ã™"}),(0,t.jsx)("button",{onClick:C,disabled:x,className:"px-6 py-2 text-red-600 border border-red-300 rounded-lg  hover:bg-red-50 disabled:opacity-50",children:x?"å‡¦ç†ä¸­...":"2FAã‚’ç„¡åŠ¹ã«ã™ã‚‹"})]}):e?(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600 mb-4 text-center",children:"èªè¨¼ã‚¢ãƒ—ãƒªï¼ˆGoogle Authenticatorç­‰ï¼‰ã§QRã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦ãã ã•ã„"}),(0,t.jsx)("div",{className:"flex justify-center mb-6",children:(0,t.jsx)("img",{src:e,alt:"2FA QR Code",className:"w-48 h-48"})}),(0,t.jsxs)("div",{className:"mb-6 p-3 bg-gray-100 rounded text-center",children:[(0,t.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"æ‰‹å‹•å…¥åŠ›ç”¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ"}),(0,t.jsx)("code",{className:"text-sm break-all",children:c})]}),(0,t.jsxs)("form",{onSubmit:I,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"èªè¨¼ã‚¢ãƒ—ãƒªã«è¡¨ç¤ºã•ã‚ŒãŸ6æ¡ã®ã‚³ãƒ¼ãƒ‰"}),(0,t.jsx)("input",{type:"text",value:d,onChange:e=>o(e.target.value.replace(/\D/g,"").slice(0,6)),required:!0,maxLength:6,className:"w-full px-4 py-3 text-center text-xl tracking-widest  border border-gray-300 rounded-lg  focus:ring-2 focus:ring-blue-500",placeholder:"000000"})]}),(0,t.jsx)("button",{type:"submit",disabled:x||6!==d.length,className:"w-full py-3 bg-blue-600 text-white rounded-lg  hover:bg-blue-700 disabled:bg-gray-400",children:x?"ç¢ºèªä¸­...":"2FAã‚’æœ‰åŠ¹ã«ã™ã‚‹"})]})]}):(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-5xl mb-4",children:"ðŸ”"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"2æ®µéšŽèªè¨¼ã‚’è¨­å®šã™ã‚‹ã¨ã€ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«èªè¨¼ã‚¢ãƒ—ãƒªã®ã‚³ãƒ¼ãƒ‰ãŒå¿…è¦ã«ãªã‚Šã€ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŒå‘ä¸Šã—ã¾ã™ã€‚"}),(0,t.jsx)("button",{onClick:w,disabled:x,className:"px-6 py-3 bg-blue-600 text-white rounded-lg  hover:bg-blue-700 disabled:bg-gray-400",children:x?"æº–å‚™ä¸­...":"2FAã‚’è¨­å®šã™ã‚‹"})]}),(0,t.jsx)("div",{className:"mt-8 text-center",children:(0,t.jsx)("button",{onClick:()=>j.push("/"),className:"text-gray-500 hover:text-gray-700",children:"â† ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹"})})]})}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("p",{children:"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„"})})}e.s(["default",()=>i])}]);