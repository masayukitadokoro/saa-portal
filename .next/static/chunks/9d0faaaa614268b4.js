(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86536,e=>{"use strict";let t=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],86536)},30217,e=>{"use strict";function t(e,t){if(!e)return"";let s=e.replace(/^(\d+(?:-\d+)?)_/,"");return t?`${t} ${s}`:e.replace(/^(\d+(?:-\d+)?)_/,"$1 ")}e.s(["formatVideoTitle",()=>t])},31343,e=>{"use strict";let t=(0,e.i(75254).default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);e.s(["Play",()=>t],31343)},63059,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>t],63059)},52951,e=>{"use strict";var t=e.i(43476),s=e.i(71645),l=e.i(22016),a=e.i(57688),r=e.i(27516),i=e.i(71930),c=e.i(63059),d=e.i(31343),n=e.i(84614),o=e.i(86536),x=e.i(30217);function m(e){if(!e)return null;let t=e.match(/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([^&?\s]+)/);return t?t[1]:null}function h(e){return`https://img.youtube.com/vi/${e}/mqdefault.jpg`}function u(e){let t=new Date,s=new Date(e),l=t.getTime()-s.getTime(),a=Math.floor(l/6e4),r=Math.floor(l/36e5),i=Math.floor(l/864e5);return a<60?`${a}分前`:r<24?`${r}時間前`:0===i?"今日":1===i?"昨日":i<7?`${i}日前`:i<30?`${Math.floor(i/7)}週間前`:`${Math.floor(i/30)}ヶ月前`}function f(e){if(!e)return"";let t=Math.floor(e/60);return`${t}:${(e%60).toString().padStart(2,"0")}`}function g(){let[e,g]=(0,s.useState)(null),[b,j]=(0,s.useState)([]),[p,y]=(0,s.useState)([]),[v,N]=(0,s.useState)(0),[w,k]=(0,s.useState)(0),[_,$]=(0,s.useState)(!0);(0,s.useEffect)(()=>{S()},[]);let S=async()=>{try{let[e,t,s,l]=await Promise.all([fetch("/api/mypage/profile"),fetch("/api/mypage/history?limit=5"),fetch("/api/mypage/bookmarks?limit=5"),fetch("/api/mypage/stats")]);if(e.ok){let t=await e.json();g(t)}if(t.ok){let e=await t.json();j(e.history||[])}if(s.ok){let e=await s.json();y(e.bookmarks||[])}if(l.ok){let e=await l.json();N(e.last24HoursWatchedCount||0),k(e.totalBookmarks||0)}}catch(e){console.error("Failed to fetch data:",e)}finally{$(!1)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center text-white text-2xl font-bold",children:e?.display_name?.[0]?.toUpperCase()||"U"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:e?.display_name||"ユーザー"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e?.email})]})]}),(0,t.jsxs)(l.default,{href:"/mypage/profile",className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[(0,t.jsx)(n.User,{className:"w-4 h-4"}),"プロフィール編集"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[(0,t.jsxs)("div",{className:"bg-blue-50 rounded-xl p-4 flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)(r.History,{className:"w-5 h-5 text-blue-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:v}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"過去1日で視聴した動画"})]})]}),(0,t.jsxs)("div",{className:"bg-amber-50 rounded-xl p-4 flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)(i.Bookmark,{className:"w-5 h-5 text-amber-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:w}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"ブックマーク"})]})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[(0,t.jsxs)("h2",{className:"flex items-center gap-2 font-bold text-gray-900",children:[(0,t.jsx)(r.History,{className:"w-5 h-5 text-blue-600"}),"最近視聴した動画"]}),(0,t.jsxs)(l.default,{href:"/mypage/history",className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:["すべて見る",(0,t.jsx)(c.ChevronRight,{className:"w-4 h-4"})]})]}),_?(0,t.jsx)("div",{className:"p-8 text-center text-gray-500",children:"読み込み中..."}):b.length>0?(0,t.jsx)("div",{className:"divide-y divide-gray-100",children:b.map(e=>{var s,r;let i=(e=>{let t=e.video;if(t?.custom_thumbnail_url)return t.custom_thumbnail_url;if(t?.thumbnail_url)return t.thumbnail_url;if(t?.video_url){let e=m(t.video_url);if(e)return h(e)}return null})(e),c=e.video,n=(s=e.progress_seconds,r=c?.duration,s&&r?Math.min(100,Math.round(s/r*100)):0);return(0,t.jsxs)(l.default,{href:`/videos/${e.video_id}`,className:"flex gap-4 p-4 hover:bg-gray-50 transition-colors",children:[(0,t.jsxs)("div",{className:"relative w-40 flex-shrink-0 aspect-video rounded-lg overflow-hidden bg-gray-200",children:[i?(0,t.jsx)(a.default,{src:i,alt:c?.title||"動画",fill:!0,className:"object-cover",unoptimized:i.includes("youtube.com")||i.includes("ytimg.com")}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsx)(d.Play,{className:"w-8 h-8 text-gray-400"})}),c?.duration&&(0,t.jsx)("span",{className:"absolute bottom-1 right-1 px-1.5 py-0.5 bg-black/80 text-white text-xs rounded",children:f(c.duration)}),n>0&&(0,t.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gray-300",children:(0,t.jsx)("div",{className:"h-full bg-red-600",style:{width:`${n}%`}})})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900 line-clamp-2 mb-1",children:(0,x.formatVideoTitle)(c?.title||"動画")}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(o.Eye,{className:"w-3.5 h-3.5"}),c?.view_count?.toLocaleString()||0,"回視聴"]}),(0,t.jsx)("span",{children:"•"}),(0,t.jsxs)("span",{children:[u(e.watched_at),"に視聴"]})]}),n>0&&n<100&&(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden max-w-48",children:(0,t.jsx)("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${n}%`}})}),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:[n,"%視聴済み"]})]}),n>=100&&(0,t.jsx)("span",{className:"inline-block mt-2 px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full",children:"視聴完了"})]})]},e.id)})}):(0,t.jsxs)("div",{className:"p-8 text-center",children:[(0,t.jsx)(r.History,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-gray-500 mb-2",children:"まだ視聴履歴がありません"}),(0,t.jsx)(l.default,{href:"/",className:"text-sm text-blue-600 hover:text-blue-700",children:"動画を見る →"})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[(0,t.jsxs)("h2",{className:"flex items-center gap-2 font-bold text-gray-900",children:[(0,t.jsx)(i.Bookmark,{className:"w-5 h-5 text-amber-500"}),"ブックマーク"]}),(0,t.jsxs)(l.default,{href:"/mypage/bookmarks",className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:["すべて見る",(0,t.jsx)(c.ChevronRight,{className:"w-4 h-4"})]})]}),_?(0,t.jsx)("div",{className:"p-8 text-center text-gray-500",children:"読み込み中..."}):p.length>0?(0,t.jsx)("div",{className:"divide-y divide-gray-100",children:p.map(e=>{let s=(e=>{if(e.custom_thumbnail_url)return e.custom_thumbnail_url;if(e.thumbnail_url)return e.thumbnail_url;if(e.video_url){let t=m(e.video_url);if(t)return h(t)}return null})(e);return(0,t.jsxs)(l.default,{href:`/videos/${e.video_id}`,className:"flex gap-4 p-4 hover:bg-gray-50 transition-colors",children:[(0,t.jsxs)("div",{className:"relative w-40 flex-shrink-0 aspect-video rounded-lg overflow-hidden bg-gray-200",children:[s?(0,t.jsx)(a.default,{src:s,alt:e.title||"動画",fill:!0,className:"object-cover",unoptimized:s.includes("youtube.com")||s.includes("ytimg.com")}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsx)(d.Play,{className:"w-8 h-8 text-gray-400"})}),e.duration&&(0,t.jsx)("span",{className:"absolute bottom-1 right-1 px-1.5 py-0.5 bg-black/80 text-white text-xs rounded",children:f(e.duration)})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900 line-clamp-2 mb-1",children:(0,x.formatVideoTitle)(e.title||"動画")}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(o.Eye,{className:"w-3.5 h-3.5"}),e.view_count?.toLocaleString()||0,"回視聴"]}),(0,t.jsx)("span",{children:"•"}),(0,t.jsxs)("span",{children:[u(e.created_at),"に保存"]})]})]})]},e.video_id)})}):(0,t.jsxs)("div",{className:"p-8 text-center",children:[(0,t.jsx)(i.Bookmark,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-gray-500 mb-2",children:"まだブックマークがありません"}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"気になる動画をブックマークして、後で見返しましょう"})]})]})]})}e.s(["default",()=>g])}]);