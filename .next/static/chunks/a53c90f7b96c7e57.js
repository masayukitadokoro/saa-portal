(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,r)=>{t.exports=e.r(76562)},3922,e=>{"use strict";e.i(29225);var t=e.i(72390);function r(){return(0,t.createBrowserClient)("https://bfjstgfcvbxlvvodqoxd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRjeHpicXBoZ25yYmJud3lvcWFmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyNDkzOTgsImV4cCI6MjA4MjgyNTM5OH0.kQI94c9Kh8KymiadcozMDi5lHSpjQN33Hl7wmN3FED8")}e.s(["createClient",()=>r])},74997,e=>{"use strict";async function t(e){try{await fetch("/api/activities",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(e){console.error("Tracking error:",e)}}e.s(["track",0,{login:()=>t({activity_type:"login"}),videoView:(e,r)=>t({activity_type:"video_view",target_id:e,target_title:r}),videoComplete:(e,r,a)=>t({activity_type:"video_complete",target_id:e,target_title:r,metadata:a?{watch_time:a}:{}}),articleView:(e,r)=>t({activity_type:"article_view",target_id:e,target_title:r}),resourceDownload:(e,r,a)=>t({activity_type:"resource_download",target_id:e,target_title:r,metadata:a?{resource_type:a}:{}}),bookmarkAdd:(e,r)=>t({activity_type:"bookmark_add",target_id:e,target_title:r}),bookmarkRemove:(e,r)=>t({activity_type:"bookmark_remove",target_id:e,target_title:r}),search:(e,r)=>t({activity_type:"search",metadata:{query:e,result_count:r}})}])},87942,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(74997),i=e.i(18566),s=e.i(22016),l=e.i(3922);function c(){let[e,c]=(0,r.useState)(""),[d,o]=(0,r.useState)(""),[n,u]=(0,r.useState)(""),[m,g]=(0,r.useState)(""),[h,b]=(0,r.useState)(!1),[p,x]=(0,r.useState)(!1),[y,f]=(0,r.useState)(""),v=(0,i.useRouter)(),j=(0,l.createClient)(),w=async t=>{t.preventDefault(),g(""),b(!0);try{let{data:t,error:r}=await j.auth.signInWithPassword({email:e,password:d});if(r){g(r.message),b(!1);return}if(t.session){let{data:e}=await j.auth.mfa.listFactors();if(e?.totp&&e.totp.length>0){let t=e.totp[0];f(t.id),x(!0),b(!1);return}}a.track.login(),v.push("/"),v.refresh()}catch(e){g("ログインに失敗しました")}finally{b(!1)}},_=async e=>{e.preventDefault(),g(""),b(!0);try{let{data:e,error:t}=await j.auth.mfa.challenge({factorId:y});if(t){g(t.message),b(!1);return}let{error:r}=await j.auth.mfa.verify({factorId:y,challengeId:e.id,code:n});if(r){g("認証コードが正しくありません"),b(!1);return}a.track.login(),v.push("/"),v.refresh()}catch(e){g("2段階認証に失敗しました")}finally{b(!1)}};return p?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow p-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-center text-gray-800 mb-4",children:"2段階認証"}),(0,t.jsx)("p",{className:"text-center text-gray-600 mb-8",children:"認証アプリに表示されている6桁のコードを入力してください"}),(0,t.jsxs)("form",{onSubmit:_,className:"space-y-6",children:[m&&(0,t.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded text-red-600 text-sm",children:m}),(0,t.jsx)("div",{children:(0,t.jsx)("input",{type:"text",value:n,onChange:e=>u(e.target.value.replace(/\D/g,"").slice(0,6)),required:!0,maxLength:6,className:"w-full px-4 py-4 text-center text-2xl tracking-widest  border border-gray-300 rounded-lg  focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"000000",autoFocus:!0})}),(0,t.jsx)("button",{type:"submit",disabled:h||6!==n.length,className:"w-full py-3 bg-blue-600 text-white rounded-lg  hover:bg-blue-700 disabled:bg-gray-400  transition-colors font-medium",children:h?"確認中...":"確認"})]})]})}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow p-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-center text-gray-800 mb-8",children:"ログイン"}),(0,t.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[m&&(0,t.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded text-red-600 text-sm",children:m}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"メールアドレス"}),(0,t.jsx)("input",{type:"email",value:e,onChange:e=>c(e.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg  focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"example@email.com"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"パスワード"}),(0,t.jsx)("input",{type:"password",value:d,onChange:e=>o(e.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg  focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"••••••••"})]}),(0,t.jsx)("button",{type:"submit",disabled:h,className:"w-full py-3 bg-blue-600 text-white rounded-lg  hover:bg-blue-700 disabled:bg-gray-400  transition-colors font-medium",children:h?"ログイン中...":"ログイン"})]}),(0,t.jsxs)("p",{className:"mt-6 text-center text-sm text-gray-600",children:["アカウントをお持ちでないですか？"," ",(0,t.jsx)(s.default,{href:"/auth/signup",className:"text-blue-600 hover:underline",children:"サインアップ"})]})]})})}e.s(["default",()=>c])}]);